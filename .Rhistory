legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
# Volcano Plot of results
library(EnhancedVolcano)
library("biomaRt")
ensembl <- useMart("ensembl",dataset="hsapiens_gene_ensembl") #retrieves human database GRCh38.p13
### P-values distribution
## P-value histogram plot
res.df <- data.frame(Feature = rownames(res.df), res.df)
data.frame(GeneID=dxr1@listData[["groupID"]], FDR=dxr1@listData[["padj"]], log2fold_change=dxr1@listData[["log2fold_WT_GBA"]])
data.frame(GeneID=dds@listData[["groupID"]], FDR=dxr1@listData[["padj"]], log2fold_change=dxr1@listData[["log2fold_WT_GBA"]])
data.frame(GeneID=dds@listData[["groupID"]], FDR=dds@listData[["padj"]], log2fold_change=dds@listData[["log2fold_WT_GBA"]])
dds@listData
View(resLFC)
View(resOrdered)
View(resSig)
View(resLFC)
resLFC@listData
resLFC@listData[["groupID"]]
View(resLFC)
Volcano_list <-data.frame(GeneID=resLFC@rownames, FDR=resLFC@listData[["padj"]], log2fold_change=resLFC@listData[["log2FoldChange"]])
View(Volcano_list)
Volcano_list <- data.frame(GeneID=resLFC@rownames, FDR=resLFC@listData[["padj"]], log2fold_change=resLFC@listData[["log2FoldChange"]]) %>%
drop_na() %>%
separate(GeneID, "ENSEMBL_ID", sep="\\.", remove=FALSE, extra="warn", fill="right") %>% #splits multiple IDs on same row and keeps the right "ENSEMBLID"
group_by(GeneID) %>%
arrange(FDR, .by_group=T) %>% #groups by Gene name and sorts them by FDR
top_n(-1, FDR) %>% # selects for each gene the one with lowest FDR
distinct()
Volcano_list <-data.frame(GeneID=resLFC@rownames, FDR=resLFC@listData[["padj"]], log2fold_change=resLFC@listData[["log2FoldChange"]])
Volcano_list <- data.frame(GeneID=resLFC@rownames, FDR=resLFC@listData[["padj"]], log2fold_change=resLFC@listData[["log2FoldChange"]]) %>%
drop_na() %>%
separate(GeneID, "ENSEMBL_ID", sep="\\.", remove=FALSE, extra="warn", fill="right") %>% #splits multiple IDs on same row and keeps the right "ENSEMBLID"
group_by(GeneID) %>%
arrange(FDR, .by_group=T) %>% #groups by Gene name and sorts them by FDR
top_n(-1, FDR) %>% # selects for each gene the one with lowest FDR
distinct()
Volcano_list <- data.frame(GeneID=resLFC@rownames, FDR=resLFC@listData[["padj"]], log2fold_change=resLFC@listData[["log2FoldChange"]]) %>%
drop_na() %>%
separate(GeneID, "ENSEMBL_ID", sep="\\.", remove=FALSE, extra="warn", fill="right") %>% #splits multiple IDs on same row and keeps the right "ENSEMBLID"
separate(GeneID, "GeneID", sep="|", remove=TRUE, extra="warn", fill="left") %>% #splits multiple IDs on same row and keeps the right "ENSEMBLID"
group_by(GeneID) %>%
arrange(FDR, .by_group=T) %>% #groups by Gene name and sorts them by FDR
top_n(-1, FDR) %>% # selects for each gene the one with lowest FDR
distinct()
Volcano_list <- data.frame(GeneID=resLFC@rownames, FDR=resLFC@listData[["padj"]], log2fold_change=resLFC@listData[["log2FoldChange"]]) %>%
drop_na() %>%
separate(GeneID, "ENSEMBL_ID", sep="\\.", remove=FALSE, extra="warn", fill="right") %>% #splits multiple IDs on same row and keeps the right "ENSEMBLID"
separate(GeneID, "GeneID", sep="|", remove=FALSE, extra="warn", fill="left") %>% #splits multiple IDs on same row and keeps the right "ENSEMBLID"
group_by(GeneID) %>%
arrange(FDR, .by_group=T) %>% #groups by Gene name and sorts them by FDR
top_n(-1, FDR) %>% # selects for each gene the one with lowest FDR
distinct()
Volcano_list <- data.frame(GeneID=resLFC@rownames, FDR=resLFC@listData[["padj"]], log2fold_change=resLFC@listData[["log2FoldChange"]]) %>%
drop_na() %>%
separate(GeneID, "ENSEMBL_ID", sep="\\.", remove=FALSE, extra="warn", fill="right") %>% #splits multiple IDs on same row and keeps the right "ENSEMBLID"
group_by(GeneID) %>%
arrange(FDR, .by_group=T) %>% #groups by Gene name and sorts them by FDR
top_n(-1, FDR) %>% # selects for each gene the one with lowest FDR
distinct()
Volcano_list <- data.frame(GeneID=resLFC@rownames, FDR=resLFC@listData[["padj"]], log2fold_change=resLFC@listData[["log2FoldChange"]]) %>%
drop_na() %>%
separate(GeneID, "ENSEMBL_ID", sep="\\.", remove=FALSE, extra="warn", fill="right") %>% #splits multiple IDs on same row and keeps the right "ENSEMBLID"
group_by(GeneID) %>%
arrange(FDR, .by_group=T) %>% #groups by Gene name and sorts them by FDR
top_n(-1, FDR) %>% # selects for each gene the one with lowest FDR
distinct()
Volcano_list_genes <- Volcano_list %>%
separate(GeneID, c("delete","Gene"), sep="\\|", remove=FALSE, extra="drop", fill="right")%>% #splits multiple IDs on same row and keeps the right
dplyr::select(-delete)
View(Volcano_list)
View(Volcano_list_genes)
Volcano_list_labels <- dplyr::filter(Volcano_list_genes, FDR<0.05)
write.csv(as.data.frame(Volcano_list_labels),
file="Significant_genes_results_0.05_T3_vs_control.csv")
FC <- 0.5
p <- 0.05
keyvals <- rep('grey75', nrow(Volcano_list_genes))
names(keyvals) <- rep('Not Significant', nrow(Volcano_list_genes))
keyvals[which(Volcano_list_genes$Log2FoldChange < -FC & Volcano_list_genes$FDR < p)] <- 'blue2'
names(keyvals)[which(Volcano_list_genes$Log2FoldChange  < -FC & Volcano_list_genes$FDR < p)] <- 'Down-regulated'
keyvals[which(Volcano_list_genes$Log2FoldChange > FC & Volcano_list_genes$FDR < p)] <- 'red2'
names(keyvals)[which(Volcano_list_genes$Log2FoldChange > FC & Volcano_list_genes$FDR < p)] <- 'Up-regulated'
unique(keyvals)
unique(names(keyvals))
volcano_plot <- EnhancedVolcano(Volcano_list_genes,
lab = Volcano_list_genes$Gene,
x = 'Log2FoldChange',
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-5.5, 5.5),
ylim = c(0, -log10(10e-12)),
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Expression pattern of tissues expressing less THRA1",
subtitle = "Differential Expression Analysis, High THRA1 expressing tissues as reference",
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
#legend=c('NS','Log (base 2) fold-change','P value', 'P value & Log (base 2) fold-change'),
#legend=c('','','P value', 'P value & Log (base 2) fold-change'),
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
View(Volcano_list_genes)
volcano_plot <- EnhancedVolcano(Volcano_list_genes,
lab = Volcano_list_genes$Gene,
x = 'Log2fold_change',
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-5.5, 5.5),
ylim = c(0, -log10(10e-12)),
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Expression pattern of tissues expressing less THRA1",
subtitle = "Differential Expression Analysis, High THRA1 expressing tissues as reference",
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
#legend=c('NS','Log (base 2) fold-change','P value', 'P value & Log (base 2) fold-change'),
#legend=c('','','P value', 'P value & Log (base 2) fold-change'),
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot <- EnhancedVolcano(Volcano_list_genes,
lab = Volcano_list_genes$Gene,
x = 'log2fold_change',
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-5.5, 5.5),
ylim = c(0, -log10(10e-12)),
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Expression pattern of tissues expressing less THRA1",
subtitle = "Differential Expression Analysis, High THRA1 expressing tissues as reference",
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
#legend=c('NS','Log (base 2) fold-change','P value', 'P value & Log (base 2) fold-change'),
#legend=c('','','P value', 'P value & Log (base 2) fold-change'),
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot
volcano_plot <- EnhancedVolcano(Volcano_list_genes,
lab = Volcano_list_genes$Gene,
x = Volcano_list_genes$log2fold_change,
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-5.5, 5.5),
ylim = c(0, -log10(10e-12)),
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Expression pattern of tissues expressing less THRA1",
subtitle = "Differential Expression Analysis, High THRA1 expressing tissues as reference",
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
#legend=c('NS','Log (base 2) fold-change','P value', 'P value & Log (base 2) fold-change'),
#legend=c('','','P value', 'P value & Log (base 2) fold-change'),
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
keyvals <- rep('grey75', nrow(Volcano_list_genes))
names(keyvals) <- rep('Not Significant', nrow(Volcano_list_genes))
keyvals[which(Volcano_list_genes$log2fold_change < -FC & Volcano_list_genes$FDR < p)] <- 'blue2'
names(keyvals)[which(Volcano_list_genes$log2fold_change  < -FC & Volcano_list_genes$FDR < p)] <- 'Down-regulated'
keyvals[which(Volcano_list_genes$log2fold_change > FC & Volcano_list_genes$FDR < p)] <- 'red2'
names(keyvals)[which(Volcano_list_genes$log2fold_change > FC & Volcano_list_genes$FDR < p)] <- 'Up-regulated'
unique(keyvals)
unique(names(keyvals))
volcano_plot <- EnhancedVolcano(Volcano_list_genes,
lab = Volcano_list_genes$Gene,
x = Volcano_list_genes$log2fold_change,
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-5.5, 5.5),
ylim = c(0, -log10(10e-12)),
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Expression pattern of tissues expressing less THRA1",
subtitle = "Differential Expression Analysis, High THRA1 expressing tissues as reference",
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
#legend=c('NS','Log (base 2) fold-change','P value', 'P value & Log (base 2) fold-change'),
#legend=c('','','P value', 'P value & Log (base 2) fold-change'),
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot <- EnhancedVolcano(Volcano_list_genes,
lab = Volcano_list_genes$Gene,
x = 'log2fold_change',
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-5.5, 5.5),
ylim = c(0, -log10(10e-12)),
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Expression pattern of tissues expressing less THRA1",
subtitle = "Differential Expression Analysis, High THRA1 expressing tissues as reference",
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
#legend=c('NS','Log (base 2) fold-change','P value', 'P value & Log (base 2) fold-change'),
#legend=c('','','P value', 'P value & Log (base 2) fold-change'),
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot
ggsave("Volcano_plot_T3_vs_control.png" , device=png, dpi = 600, path = figures_path, bg = "transparent", width = 20, height = 12, units = "cm" )
volcano_plot <- EnhancedVolcano(Volcano_list_genes,
lab = Volcano_list_genes$Gene,
x = 'log2fold_change',
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-5.5, 5.5),
ylim = c(0, -log10(10e-12)),
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Expression pattern of tissues expressing less THRA1",
subtitle = "Differential Expression Analysis, High THRA1 expressing tissues as reference",
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
#legend=c('NS','Log (base 2) fold-change','P value', 'P value & Log (base 2) fold-change'),
#legend=c('','','P value', 'P value & Log (base 2) fold-change'),
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot
ggsave("Volcano_plot_T3_vs_control.png" , device=png, dpi = 600, path = figures_path, bg = "transparent", width = 40, height = 25, units = "cm" )
ggsave("Volcano_plot_T3_vs_control.png" , device=png, dpi = 600, path = figures_path, bg = "transparent", width = 35, height = 20, units = "cm" )
volcano_plot
ggsave("Volcano_plot_T3_vs_control.png" , device=png, dpi = 600, path = figures_path, bg = "transparent", width = 35, height = 20, units = "cm" )
###load libraries
library("DESeq2")
library(tidyverse)
library(ggrepel)
library(dplyr)
### set output paths
figures_path <- "~/OneDrive - Charité - Universitätsmedizin Berlin/Schuelke_Lab/EG15_RNA_Seq/Brain_organoids/Figures"
### Load gene(/transcript) count matrix and labels
countData <- as.matrix(read.csv("gene_count_matrix.csv", row.names="gene_id", check.names = FALSE))
colData <- read.csv("Metadata_brain_organoids.csv",
sep=";",row.names="Sample")
colData$study_day <-as.factor(colData$study_day)
colData
### Check all sample IDs in colData are also in CountData and match their orders
all(rownames(colData) %in% colnames(countData))
countData <- countData[, rownames(colData)]
all(rownames(colData) == colnames(countData))
### Create a DESeqDataSet from count matrix and labels
dds <- DESeqDataSetFromMatrix(countData = countData,
colData = colData, design =  ~ study_day + Treatment + study_day:Treatment)
### pre-filtering to increase speed and reduce memory requirements
keep <- rowSums(counts(dds)) >= 10
dds <- dds[keep,]
colData(dds)
head( counts(dds), 5 )
dds_day26 <- subset(dds, select=colData(dds)$type=="26")
dds_day26
View(dds_day26)
colData(dds_day26)
head( counts(dds_day26), 5 )
colData(dds_day26)
head( counts(dds_day26), 5 )
dds_day26 <- subset(dds, select=colData(dds)$type=="26")
dds_day26
dds_day26 <- subset(dds, select=colData(dds)$study_day=="26")
dds_day26
colData(dds_day26)
head( counts(dds_day26), 5 )
### we want a list of the DE genes between T3 vs control for each time point
### to do this, I will subset the dds element and run DESeq
dds_day26 <- subset(dds, select=colData(dds)$study_day=="26")
dds_day26
colData(dds_day26)
head( counts(dds_day26), 5 )
#set the reference level
dds_day26$Treatment <- relevel(dds_day26$Treatment, ref = "control")
### run DESeq2 and calulate the results
dds_day26 <- DESeq(dds_day26)
### run DESeq2 and calulate the results
dds_day26 <- DESeq(dds_day26)
dds_day26 <- subset(dds, select=colData(dds)$study_day=="26")
dds_day26
dds_day26 <- dds[dds$study_day == "26"]
dds_day26
dds_day26 <- subset(dds, select=colData(dds)$study_day=="26")
dds_day26
dds_day26 <- dds[dds$study_day == "26"]
dds_day26
dds_day26 <- subset(dds, select=colData(dds)$study_day=="26")
dds_day26
design(dds_day26) = formula(~Treatment)
dds_day26
colData(dds_day26)
head( counts(dds_day26), 5 )
#set the reference level
dds_day26$Treatment <- relevel(dds_day26$Treatment, ref = "control")
### run DESeq2 and calulate the results
dds_day26 <- DESeq(dds_day26)
res_day26 <- results(dds_day26)
res_day26
res_day26
resultsNames(res_day26)
resultsNames(res_day26)
resultsNames(res_day26)
res_day26
resLFC_day26 <- lfcShrink(dds_day26,  type="apeglm")
resLFC_day26 <- lfcShrink(res_day26,  type="apeglm")
### p-values and adjusted p-values
resOrdered_day26 <- res_day26[order(res_day26$padj), ]
summary(res_day26)
### How many adjusted p-values were less than 0.05?
sum(res_day26$padj < 0.05, na.rm=TRUE)
### How many adjusted p-values were less than 0.05?
sum(res_day26$padj < 0.05, na.rm=TRUE)
### exporting the results
resSig_day26 <- subset(res_day26, padj < 0.05)
resSig_day26
View(resSig_day26)
write.csv(as.data.frame(resSig_day26),
file="T3_vs_control_results_day26.csv")
dds_day46 <- subset(dds, select=colData(dds)$study_day=="46")
design(dds_day46) = formula(~Treatment)
dds_day46
colData(dds_day46)
head( counts(dds_day46), 5 )
#set the reference level
dds_day46$Treatment <- relevel(dds_day46$Treatment, ref = "control")
### run DESeq2 and calulate the results
dds_day46 <- DESeq(dds_day46)
res_day46 <- results(dds_day46)
res_day46
### p-values and adjusted p-values
resOrdered_day46 <- res_day46[order(res_day46$padj), ]
summary(res_day46)
### How many adjusted p-values were less than 0.05?
sum(res_day46$padj < 0.05, na.rm=TRUE)
### exporting the results
resSig_day46 <- subset(res_day46, padj < 0.05)
resSig_day46
write.csv(as.data.frame(resSig_day46),
file="T3_vs_control_results_day46.csv")
dds_day61 <- subset(dds, select=colData(dds)$study_day=="61")
design(dds_day61) = formula(~Treatment)
dds_day61
colData(dds_day61)
head( counts(dds_day61), 5 )
#set the reference level
dds_day61$Treatment <- relevel(dds_day61$Treatment, ref = "control")
### run DESeq2 and calulate the results
dds_day61 <- DESeq(dds_day61)
res_day61 <- results(dds_day61)
res_day61 <- results(dds_day61)
res_day61
### p-values and adjusted p-values
resOrdered_day61 <- res_day61[order(res_day61$padj), ]
summary(res_day61)
### How many adjusted p-values were less than 0.05?
sum(res_day61$padj < 0.05, na.rm=TRUE)
### exporting the results
resSig_day61 <- subset(res_day61, padj < 0.05)
resSig_day61
write.csv(as.data.frame(resSig_day61),
file="T3_vs_control_results_day61.csv")
View(res_day26)
View(res_day46)
View(res_day61)
View(resSig_day26)
View(resSig_day46)
View(resSig_day61)
test <- as.data.frame(resSig_day61)
test
test <- as.data.frame(resSig_day26)
test <- as.data.frame(resSig_day26)
test
View(test)
test <- as.data.frame(resSig_day26) %>%
mutate("Gene"=rownames(resSig_day26)) %>%
select(Gene, log2FoldChange, "FDR" = padj )
test
test <- as.data.frame(resSig_day46) %>%
mutate("Gene"=rownames(resSig_day46)) %>%
select(Gene, log2FoldChange, "FDR" = padj )
test
df_day26 <- as.data.frame(resSig_day26) %>%
mutate("Gene"=rownames(resSig_day26)) %>%
select(Gene, log2FoldChange, "FDR" = padj )
df_day46 <- as.data.frame(resSig_day46) %>%
mutate("Gene"=rownames(resSig_day46)) %>%
select(Gene, log2FoldChange, "FDR" = padj )
df_day61 <- as.data.frame(resSig_day61) %>%
mutate("Gene"=rownames(resSig_day61)) %>%
select(Gene, log2FoldChange, "FDR" = padj )
DE_genes <- inner_join(df_day46, df_day61, by="Gene")
View(DE_genes)
df_day26 <- as.data.frame(resSig_day26) %>%
mutate("Gene"=rownames(resSig_day26)) %>%
select(Gene,"log2FoldChange_day26"= log2FoldChange, "FDR_day26" = padj )
df_day46 <- as.data.frame(resSig_day46) %>%
mutate("Gene"=rownames(resSig_day46)) %>%
select(Gene,"log2FoldChange_day46"= log2FoldChange, "FDR_day46" = padj )
df_day61 <- as.data.frame(resSig_day61) %>%
mutate("Gene"=rownames(resSig_day61)) %>%
select(Gene,"log2FoldChange_day61"= log2FoldChange, "FDR_day61" = padj )
DE_genes <- inner_join(df_day46, df_day61, by="Gene")
DE_genes <- inner_join(df_day46, df_day61, by="Gene") %>%
full_join(df_day26)
DE_genes
DE_genes <- inner_join(df_day46, df_day61, by="Gene") %>%
full_join(df_day26) %>%
separate(Gene, c("ENSEMBL_ID","Gene"), sep="\\|", remove=FALSE, extra="drop", fill="right")%>% #splits multiple IDs on same row and keeps the right
DE_genes
DE_genes <- inner_join(df_day46, df_day61, by="Gene") %>%
full_join(df_day26) %>%
separate(Gene, c("ENSEMBL_ID","Gene"), sep="\\|", remove=FALSE, extra="drop", fill="right")%>% #splits multiple IDs on same row and keeps the right
DE_genes
DE_genes <- inner_join(df_day46, df_day61, by="Gene") %>%
full_join(df_day26) %>%
separate(Gene, c("ENSEMBL_ID","Gene"), sep="\\|", remove=FALSE, extra="drop", fill="right")
DE_genes <- inner_join(df_day46, df_day61, by="Gene") %>%
full_join(df_day26) %>%
separate(Gene, c("ENSEMBL_ID","Gene"), sep="\\|", remove=TRUE, extra="drop", fill="right")
write.csv(DE_genes,  file="T3_vs_control_results_independent.csv")
library(readr)
T3_vs_control_results <- read_csv("T3_vs_control_results.csv")
View(T3_vs_control_results)
