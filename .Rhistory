colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot
volcano_plot
ggsave("Volcano_plot_T3_vs_control_day46_day61_independent.png" , device=png, dpi = 600, path = figures_path, bg = "transparent", width = 35, height = 20, units = "cm" )
volcano_plot <- EnhancedVolcano(Volcano_list_day46_day61_independent,
lab = Volcano_list_day46_day61_independent$Gene,
x = 'log2fold_change',
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-5.5, 5.5),
ylim = c(0, -log10(10e-80)),
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Differentially Expressed Genes - day46 and day61 processed independently",
subtitle = paste0("Total of ",as.character(count(DE_genes)), " significant genes"),
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot
volcano_plot <- EnhancedVolcano(Volcano_list_day46_day61_independent,
lab = Volcano_list_day46_day61_independent$Gene,
x = 'log2fold_change',
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-5.5, 5.5),
ylim = c(0, -log10(10e-100)),
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Differentially Expressed Genes - day46 and day61 processed independently",
subtitle = paste0("Total of ",as.character(count(DE_genes)), " significant genes"),
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot
ggsave("Volcano_plot_T3_vs_control_day46_day61_independent.png" , device=png, dpi = 600, path = figures_path, bg = "transparent", width = 35, height = 20, units = "cm" )
Volcano_list_day46_day61_independent <- data.frame(GeneID=res_day46@rownames, FDR=res_day46@listData[["padj"]], log2fold_change=res_day46@listData[["log2FoldChange"]]) %>%
drop_na() %>%
separate(GeneID, c("ENSEMBL_ID","Gene"), sep="\\|", remove=TRUE, extra="drop", fill="right") %>%
group_by(ENSEMBL_ID) %>%
arrange(FDR, .by_group=T) %>% #groups by Gene name and sorts them by FDR
top_n(-1, FDR) %>% # selects for each gene the one with lowest FDR
distinct()
FC <- 0.5
p <- 0.05
keyvals <- rep('grey75', nrow(Volcano_list_day46_day61_independent))
names(keyvals) <- rep('Not Significant', nrow(Volcano_list_day46_day61_independent))
keyvals[which(Volcano_list_day46_day61_independent$log2fold_change < -FC & Volcano_list_day46_day61_independent$FDR < p)] <- 'blue2'
names(keyvals)[which(Volcano_list_day46_day61_independent$log2fold_change  < -FC & Volcano_list_day46_day61_independent$FDR < p)] <- 'Down-regulated'
keyvals[which(Volcano_list_day46_day61_independent$log2fold_change > FC & Volcano_list_day46_day61_independent$FDR < p)] <- 'red2'
names(keyvals)[which(Volcano_list_day46_day61_independent$log2fold_change > FC & Volcano_list_day46_day61_independent$FDR < p)] <- 'Up-regulated'
unique(keyvals)
unique(names(keyvals))
volcano_plot <- EnhancedVolcano(Volcano_list_day46_day61_independent,
lab = Volcano_list_day46_day61_independent$Gene,
x = 'log2fold_change',
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-5.5, 5.5),
ylim = c(0, -log10(10e-115)),
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Differentially Expressed Genes - day46 and day61 processed independently",
subtitle = paste0("Total of ",as.character(count(DE_genes)), " significant genes"),
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot
ggsave("Volcano_plot_T3_vs_control_day46_day61_independent.png" , device=png, dpi = 600, path = figures_path, bg = "transparent", width = 35, height = 20, units = "cm" )
volcano_plot <- EnhancedVolcano(Volcano_list_day46_day61_independent,
lab = Volcano_list_day46_day61_independent$Gene,
x = 'log2fold_change',
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-5.5, 5.5),
ylim = c(0, -log10(10e-120)),
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Differentially Expressed Genes - day46 and day61 processed independently",
subtitle = paste0("Total of ",as.character(count(DE_genes)), " significant genes"),
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot
volcano_plot
ggsave("Volcano_plot_T3_vs_control_day46_day61_independent.png" , device=png, dpi = 600, path = figures_path, bg = "transparent", width = 35, height = 20, units = "cm" )
volcano_plot <- EnhancedVolcano(Volcano_list_day46_day61_independent,
lab = Volcano_list_day46_day61_independent$Gene,
x = 'log2fold_change',
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-5.5, 5.5),
ylim = c(0, -log10(10e-150)),
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Differentially Expressed Genes - day46 and day61 processed independently",
subtitle = paste0("Total of ",as.character(count(DE_genes)), " significant genes"),
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot
volcano_plot <- EnhancedVolcano(Volcano_list_day46_day61_independent,
lab = Volcano_list_day46_day61_independent$Gene,
x = 'log2fold_change',
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-10, 10),
ylim = c(0, -log10(10e-120)),
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Differentially Expressed Genes - day46 and day61 processed independently",
subtitle = paste0("Total of ",as.character(count(DE_genes)), " significant genes"),
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot
ggsave("Volcano_plot_T3_vs_control_day46_day61_independent.png" , device=png, dpi = 600, path = figures_path, bg = "transparent", width = 35, height = 20, units = "cm" )
Volcano_list_day46_day61_independent <- data.frame(GeneID=res_day61@rownames, FDR=res_day61@listData[["padj"]], log2fold_change=res_day61@listData[["log2FoldChange"]]) %>%
drop_na() %>%
separate(GeneID, c("ENSEMBL_ID","Gene"), sep="\\|", remove=TRUE, extra="drop", fill="right") %>%
group_by(ENSEMBL_ID) %>%
arrange(FDR, .by_group=T) %>% #groups by Gene name and sorts them by FDR
top_n(-1, FDR) %>% # selects for each gene the one with lowest FDR
distinct()
Volcano_list_day46_day61_independent <- data.frame(GeneID=res_day46@rownames, FDR=res_day46@listData[["padj"]], log2fold_change=res_day46@listData[["log2FoldChange"]]) %>%
drop_na() %>%
separate(GeneID, c("ENSEMBL_ID","Gene"), sep="\\|", remove=TRUE, extra="drop", fill="right") %>%
group_by(ENSEMBL_ID) %>%
arrange(FDR, .by_group=T) %>% #groups by Gene name and sorts them by FDR
top_n(-1, FDR) %>% # selects for each gene the one with lowest FDR
distinct()
Volcano_list_day46_day61_independent <- data.frame(GeneID=res_day46@rownames, FDR=res_day46@listData[["padj"]], log2fold_change=res_day46@listData[["log2FoldChange"]]) %>%
drop_na() %>%
separate(GeneID, c("ENSEMBL_ID","Gene"), sep="\\|", remove=TRUE, extra="drop", fill="right") %>%
group_by(ENSEMBL_ID) %>%
arrange(FDR, .by_group=T) %>% #groups by Gene name and sorts them by FDR
top_n(-1, FDR) %>% # selects for each gene the one with lowest FDR
distinct()
Volcano_list_day46_day61_independent <- data.frame(GeneID=res_day46@rownames, FDR=res_day46@listData[["padj"]], log2fold_change=res_day46@listData[["log2FoldChange"]]) %>%
drop_na() %>%
separate(GeneID, c("ENSEMBL_ID","Gene"), sep="\\|", remove=TRUE, extra="drop", fill="right") %>%
group_by(ENSEMBL_ID) %>%
arrange(FDR, .by_group=T) %>% #groups by Gene name and sorts them by FDR
top_n(-1, FDR) %>% # selects for each gene the one with lowest FDR
distinct()
FC <- 0.5
p <- 0.05
keyvals <- rep('grey75', nrow(Volcano_list_day46_day61_independent))
names(keyvals) <- rep('Not Significant', nrow(Volcano_list_day46_day61_independent))
keyvals[which(Volcano_list_day46_day61_independent$log2fold_change < -FC & Volcano_list_day46_day61_independent$FDR < p)] <- 'blue2'
names(keyvals)[which(Volcano_list_day46_day61_independent$log2fold_change  < -FC & Volcano_list_day46_day61_independent$FDR < p)] <- 'Down-regulated'
keyvals[which(Volcano_list_day46_day61_independent$log2fold_change > FC & Volcano_list_day46_day61_independent$FDR < p)] <- 'red2'
names(keyvals)[which(Volcano_list_day46_day61_independent$log2fold_change > FC & Volcano_list_day46_day61_independent$FDR < p)] <- 'Up-regulated'
unique(keyvals)
unique(names(keyvals))
volcano_plot <- EnhancedVolcano(Volcano_list_day46_day61_independent,
lab = Volcano_list_day46_day61_independent$Gene,
x = 'log2fold_change',
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-10, 10),
ylim = c(0, -log10(10e-120)),
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Differentially Expressed Genes - day46 and day61 processed independently",
subtitle = paste0("Total of ",as.character(count(DE_genes)), " significant genes"),
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot
ggsave("Volcano_plot_T3_vs_control_day46_day61_independent.png" , device=png, dpi = 600, path = figures_path, bg = "transparent", width = 35, height = 20, units = "cm" )
Volcano_list_day46_day61_together <- data.frame(GeneID=res_day46_and_61@rownames, FDR=res_day46_and_61@listData[["padj"]], log2fold_change=res_day46_and_61@listData[["log2FoldChange"]]) %>%
drop_na() %>%
separate(GeneID, c("ENSEMBL_ID","Gene"), sep="\\|", remove=TRUE, extra="drop", fill="right") %>%
group_by(ENSEMBL_ID) %>%
arrange(FDR, .by_group=T) %>% #groups by Gene name and sorts them by FDR
top_n(-1, FDR) %>% # selects for each gene the one with lowest FDR
distinct()
View(Volcano_list_day46_day61_together)
FC <- 0.5
p <- 0.05
keyvals <- rep('grey75', nrow(Volcano_list_day46_day61_together))
names(keyvals) <- rep('Not Significant', nrow(Volcano_list_day46_day61_together))
keyvals[which(Volcano_list_day46_day61_together$log2fold_change < -FC & Volcano_list_day46_day61_together$FDR < p)] <- 'blue2'
names(keyvals)[which(Volcano_list_day46_day61_together$log2fold_change  < -FC & Volcano_list_day46_day61_together$FDR < p)] <- 'Down-regulated'
keyvals[which(Volcano_list_day46_day61_together$log2fold_change > FC & Volcano_list_day46_day61_together$FDR < p)] <- 'red2'
names(keyvals)[which(Volcano_list_day46_day61_together$log2fold_change > FC & Volcano_list_day46_day61_together$FDR < p)] <- 'Up-regulated'
unique(keyvals)
unique(names(keyvals))
volcano_plot <- EnhancedVolcano(Volcano_list_day46_day61_together,
lab = Volcano_list_day46_day61_together$Gene,
x = 'log2fold_change',
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-5.5, 5.5),
ylim = c(0, -log10(10e-12)),
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Differentially Expressed Genes - day46 and day61 in one dds object",
subtitle = paste0("Total of ",as.character(count(df_day46_and_61)), " significant genes"),
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot <- EnhancedVolcano(Volcano_list_day46_day61_together,
lab = Volcano_list_day46_day61_together$Gene,
x = 'log2fold_change',
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-8, 25),
ylim = c(0, -log10(10e-70)),  #check that it contains all the genes
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Differentially Expressed Genes - day46 and day61 in one dds object",
subtitle = paste0("Total of ",as.character(count(df_day46_and_61)), " significant genes"),
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot
volcano_plot
ggsave("Volcano_plot_T3_vs_control_day46_day61_together.png" , device=png, dpi = 600, path = figures_path, bg = "transparent", width = 35, height = 20, units = "cm" )
volcano_plot <- EnhancedVolcano(Volcano_list_day46_day61_together,
lab = Volcano_list_day46_day61_together$Gene,
x = 'log2fold_change',
y = 'FDR',
#selectLab = GBA_final_list$gene ,
#selectLab = c('ENSG00000153113','ENSG00000142192', 'ENSG00000168002', 'ENSG00000087460', 'ENSG00000148935', 'ENSG00000138162'), #for specific genes
pCutoff = 0.05,
FCcutoff = 0.5,
xlim = c(-8, 8),
ylim = c(0, -log10(10e-70)),  #check that it contains all the genes
colCustom = keyvals,
xlab = bquote(~Log[2]~ 'fold change'),
ylab = bquote(~-Log[10] ~ italic(Padj)),
pointSize = 2.5,
#labSize = 3.0,
#shape = c(6, 6, 19, 16),
title = "Differentially Expressed Genes - day46 and day61 in one dds object",
subtitle = paste0("Total of ",as.character(count(df_day46_and_61)), " significant genes"),
caption = "Fold Change cutoff = 0.5; Padj (FDR) cutoff = 0.05",
legendPosition = "right",
legendLabSize = 15,
legendIconSize = 10,
col = c("grey30", "grey30", "royalblue", "red2"),
colAlpha = 0.8,
drawConnectors = TRUE,
widthConnectors = 0.6,
colConnectors = 'grey50',
boxedLabels=T,labSize =3)
volcano_plot
ggsave("Volcano_plot_T3_vs_control_day46_day61_together.png" , device=png, dpi = 600, path = figures_path, bg = "transparent", width = 35, height = 20, units = "cm" )
###load libraries
library("DESeq2")
library(tidyverse)
library(ggrepel)
library(dplyr)
### set output paths
figures_path <- "~/OneDrive - Charité - Universitätsmedizin Berlin/Schuelke_Lab/EG15_RNA_Seq/Brain_organoids/Figures"
### Load gene(/transcript) count matrix and labels
countData <- as.matrix(read.csv("gene_count_matrix.csv", row.names="gene_id", check.names = FALSE))
colData <- read.csv("Metadata_brain_organoids.csv",
sep=";",row.names="Sample")
colData$study_day <-as.factor(colData$study_day)
colData
### Check all sample IDs in colData are also in CountData and match their orders
all(rownames(colData) %in% colnames(countData))
countData <- countData[, rownames(colData)]
all(rownames(colData) == colnames(countData))
### Create a DESeqDataSet from count matrix and labels
dds <- DESeqDataSetFromMatrix(countData = countData,
colData = colData, design =  ~ study_day + Treatment + study_day:Treatment)
### pre-filtering to increase speed and reduce memory requirements
keep <- rowSums(counts(dds)) >= 10
dds <- dds[keep,]
###
colData(dds)
head( counts(dds), 5 )
#set the reference level
dds$Treatment <- relevel(dds$Treatment, ref = "control")
### run DESeq2 and calulate the results
dds <- DESeq(dds)
res <- results(dds)
res
### How many adjusted p-values were less than 0.05?
sum(res$padj < 0.05, na.rm=TRUE)
dds_day26 <- subset(dds, select=colData(dds)$study_day=="26")
design(dds_day26) = formula(~Treatment)
colData(dds_day26)
head( counts(dds_day26), 5 )
#set the reference level
dds_day26$Treatment <- relevel(dds_day26$Treatment, ref = "control")
### run DESeq2 and calulate the results
dds_day26 <- DESeq(dds_day26)
res_day26 <- results(dds_day26)
res_day26
### p-values and adjusted p-values
resOrdered_day26 <- res_day26[order(res_day26$padj), ]
summary(res_day26)
### How many adjusted p-values were less than 0.05?
sum(res_day26$padj < 0.05, na.rm=TRUE)
### exporting the results
resSig_day26 <- subset(res_day26, padj < 0.05)
resSig_day26
dds_day46 <- subset(dds, select=colData(dds)$study_day=="46")
design(dds_day46) = formula(~Treatment)
dds_day46
colData(dds_day46)
head( counts(dds_day46), 5 )
#set the reference level
dds_day46$Treatment <- relevel(dds_day46$Treatment, ref = "control")
### run DESeq2 and calulate the results
dds_day46 <- DESeq(dds_day46)
res_day46 <- results(dds_day46)
res_day46 <- results(dds_day46)
res_day46
### p-values and adjusted p-values
resOrdered_day46 <- res_day46[order(res_day46$padj), ]
summary(res_day46)
### How many adjusted p-values were less than 0.05?
sum(res_day46$padj < 0.05, na.rm=TRUE)
### exporting the results
resSig_day46 <- subset(res_day46, padj < 0.05)
resSig_day46
dds_day61 <- subset(dds, select=colData(dds)$study_day=="61")
design(dds_day61) = formula(~Treatment)
dds_day61
colData(dds_day61)
head( counts(dds_day61), 5 )
#set the reference level
dds_day61$Treatment <- relevel(dds_day61$Treatment, ref = "control")
### run DESeq2 and calulate the results
dds_day61 <- DESeq(dds_day61)
res_day61 <- results(dds_day61)
res_day61 <- results(dds_day61)
res_day61
### p-values and adjusted p-values
resOrdered_day61 <- res_day61[order(res_day61$padj), ]
summary(res_day61)
### How many adjusted p-values were less than 0.05?
sum(res_day61$padj < 0.05, na.rm=TRUE)
### exporting the results
resSig_day61 <- subset(res_day61, padj < 0.05)
resSig_day61
df_day26 <- as.data.frame(resSig_day26) %>%
mutate("Gene"=rownames(resSig_day26)) %>%
select(Gene,"log2FoldChange_day26"= log2FoldChange, "FDR_day26" = padj )
df_day46 <- as.data.frame(resSig_day46) %>%
mutate("Gene"=rownames(resSig_day46)) %>%
select(Gene,"log2FoldChange_day46"= log2FoldChange, "FDR_day46" = padj )
df_day61 <- as.data.frame(resSig_day61) %>%
mutate("Gene"=rownames(resSig_day61)) %>%
select(Gene,"log2FoldChange_day61"= log2FoldChange, "FDR_day61" = padj )
DE_genes <- inner_join(df_day46, df_day61, by="Gene") %>%
#full_join(df_day26) %>%
separate(Gene, c("ENSEMBL_ID","Gene"), sep="\\|", remove=TRUE, extra="drop", fill="right")
DE_genes
dds_day46_and_61 <- subset(dds, select=colData(dds)$study_day!="26")
design(dds_day46_and_61) = formula(~Treatment)
dds_day46_and_61
colData(dds_day46_and_61)
head( counts(dds_day46_and_61), 5 )
#set the reference level
dds_day46_and_61$Treatment <- relevel(dds_day46_and_61$Treatment, ref = "control")
### run DESeq2 and calulate the results
dds_day46_and_61 <- DESeq(dds_day46_and_61)
res_day46_and_61 <- results(dds_day46_and_61)
res_day46_and_61
### p-values and adjusted p-values
resOrdered_day46_and_61 <- res_day46_and_61[order(res_day46_and_61$padj), ]
summary(res_day46_and_61)
### How many adjusted p-values were less than 0.05?
sum(res_day46_and_61$padj < 0.05, na.rm=TRUE)
### exporting the results
resSig_day46_and_61 <- subset(res_day46_and_61, padj < 0.05)
resSig_day46_and_61
### preparing for export
df_day46_and_61 <- as.data.frame(resSig_day46_and_61) %>%
mutate("Gene"=rownames(resSig_day46_and_61)) %>%
select(Gene,"log2FoldChange_day46_day61"= log2FoldChange, "FDR_day46_day61" = padj ) %>%
separate(Gene, c("ENSEMBL_ID","Gene"), sep="\\|", remove=TRUE, extra="drop", fill="right")
View(res_day46_and_61)
View(df_day46_and_61)
write.csv(df_day46_and_61,
file="T3_vs_control_results_day46_and_61.csv")
