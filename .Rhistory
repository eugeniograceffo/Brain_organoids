title= "THRA expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')
ggbarplot(graph_data, x = "study_day", y = "THRA", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#820933")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(80, 220, 255)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')
ggbarplot(graph_data, x = "study_day", y = "THRA", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(80, 220, 255)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')
ggbarplot(graph_data, x = "study_day", y = "THRA", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(80, 220, 255)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')
## save plot
ggsave("Treatment_barchart_over_time_THRA.png" , device=png, dpi = 600, path = path_plots, bg = "transparent", width = 20, height = 15, units = "cm" )
ggbarplot(graph_data, x = "study_day", y = "THRA1", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(80, 220, 255)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA1 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')
ggbarplot(graph_data, x = "study_day", y = "THRA1", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(300, 850, 850)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA1 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')
ggbarplot(graph_data, x = "study_day", y = "THRA1", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(300, 850, 800)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA1 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')
ggbarplot(graph_data, x = "study_day", y = "THRA1", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(300, 850, 800)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA1 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')
## save plot
ggsave("Treatment_barchart_over_time_THRA1.png" , device=png, dpi = 600, path = path_plots, bg = "transparent", width = 20, height = 15, units = "cm" )
### Plot of Control vs T3 pulse over time - THRA2
ggbarplot(graph_data, x = "study_day", y = "THRA2", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(300, 850, 800)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA2 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')
### Plot of Control vs T3 pulse over time - THRA2
ggbarplot(graph_data, x = "study_day", y = "THRA2", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(800, 1600, 2200)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA2 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')
### Plot of Control vs T3 pulse over time - THRA2
ggbarplot(graph_data, x = "study_day", y = "THRA2", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(800, 1600, 2100)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA2 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')
### Plot of Control vs T3 pulse over time - THRA2
ggbarplot(graph_data, x = "study_day", y = "THRA2", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(800, 1600, 2100)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA2 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right') +
theme_light(base_size = 12)
### Plot of Control vs T3 pulse over time - THRA2
ggbarplot(graph_data, x = "study_day", y = "THRA2", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(800, 1600, 2100)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA2 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right') +
theme_light(base_size = 14)
### Plot of Control vs T3 pulse over time - THRA2
ggbarplot(graph_data, x = "study_day", y = "THRA2", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(800, 1600, 2100)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA2 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right') +
theme_light(base_size = 50)
### Plot of Control vs T3 pulse over time - THRA2
ggbarplot(graph_data, x = "study_day", y = "THRA2", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(800, 1600, 2100)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA2 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right') +
theme_light(base_size = 16)
### Plot of Control vs T3 pulse over time - THRA2
ggbarplot(graph_data, x = "study_day", y = "THRA2", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(800, 1600, 2100)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA2 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right') +
theme_light(base_size = 14)
### Plot of Control vs T3 pulse over time - THRA2
ggbarplot(graph_data, x = "study_day", y = "THRA2", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(800, 1600, 2100)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA2 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right') +
theme_light(base_size = 12)
### Plot of Control vs T3 pulse over time - THRA2
ggbarplot(graph_data, x = "study_day", y = "THRA2", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(800, 1600, 2100)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA2 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right') +
theme_light(base_size = 14)
ggbarplot(graph_data, x = "study_day", y = "THRA", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(80, 220, 255)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')+
theme_light(base_size = 14)
## save plot
ggsave("Treatment_barchart_over_time_THRA.png" , device=png, dpi = 600, path = path_plots, bg = "transparent", width = 20, height = 15, units = "cm" )
ggbarplot(graph_data, x = "study_day", y = "THRA1", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(300, 850, 800)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA1 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')+
theme_light(base_size = 14)
## save plot
ggsave("Treatment_barchart_over_time_THRA1.png" , device=png, dpi = 600, path = path_plots, bg = "transparent", width = 20, height = 15, units = "cm" )
### Plot of Control vs T3 pulse over time - THRA2
ggbarplot(graph_data, x = "study_day", y = "THRA2", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(800, 1600, 2100)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA2 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right') +
theme_light(base_size = 14)
## save plot
ggsave("Treatment_barchart_over_time_THRA2.png" , device=png, dpi = 600, path = path_plots, bg = "transparent", width = 20, height = 15, units = "cm" )
ggplot(total_plot, aes(x=study_day, y=Expression, label=Isoform)) +
geom_bar(stat='summary', position = "stack", aes(fill=Isoform), width=.5)  +
theme_light(base_size = 14)+
scale_y_continuous("Read counts") +
scale_fill_manual(name="Isoform",
labels = c( "THRA1", "THRA2"),
values = c("THRA1"="#A2D2DB", "THRA2"="#5A7C86")) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA isoform expression pattern",
caption = "~78M uniquely mapped reads, n>=2")
# Barchart showing Expression of A1 and A2 over time in only control samples
total_plot <- filter(dataset_final, Treatment == "control") %>%
select(Sample,study_day,  THRA1, THRA2)
total_plot <- total_plot[order(total_plot$THRA2), ]  # sort
total_plot$Sample <- factor(total_plot$Sample, levels = total_plot$Sample)  # convert to factor to retain sorted order in plot.
total_plot <- pivot_longer(total_plot, c("THRA1","THRA2"), names_to = "Isoform", values_to = "Expression")
ggplot(total_plot, aes(x=study_day, y=Expression, label=Isoform)) +
geom_bar(stat='summary', position = "stack", aes(fill=Isoform), width=.5)  +
theme_light(base_size = 14)+
scale_y_continuous("Read counts") +
scale_fill_manual(name="Isoform",
labels = c( "THRA1", "THRA2"),
values = c("THRA1"="#A2D2DB", "THRA2"="#5A7C86")) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA isoform expression pattern",
caption = "~78M uniquely mapped reads, n>=2")
ggsave("THRA1_THRA2_mosdepth_over_time_control.png" , device=png, dpi = 600, path = path_plots, bg = "transparent", width = 20, height = 15, units = "cm" )
ggplot(total_plot, aes(x=study_day, y=Expression, label=Isoform)) +
geom_bar(stat='summary', position = "stack", aes(fill=Isoform), width=.5)  +
theme_light(base_size = 14)+
scale_y_continuous("Read counts") +
scale_fill_manual(name="Isoform",
labels = c( "THRA1", "THRA2"),
values = c("THRA1"="#A2D2DB", "THRA2"="#5A7C86")) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA isoform expression pattern",
caption = "~78M uniquely mapped reads, n>=2")
# Diverging Barcharts oh total THRA
total_plot <- filter(dataset_final, Package == "mosdepth") %>%
select(Sample, "THRA1" = THRA1_Percentage,"THRA2" = THRA2_Percentage)
total_plot <- total_plot[order(total_plot$THRA2), ]  # sort
total_plot$Sample <- factor(total_plot$Sample, levels = total_plot$Sample)  # convert to factor to retain sorted order in plot.
total_plot <- pivot_longer(total_plot, c("THRA1","THRA2"), names_to = "Isoform", values_to = "Expression")
ggplot(total_plot, aes(x=Sample, y=Expression, label=Isoform)) +
geom_bar(stat='identity',position = "stack", aes(fill=Isoform), width=.5)  +
theme_light(base_size = 12)+
scale_fill_manual(name="Isoform",
labels = c( "THRA1", "THRA2"),
values = c("THRA1"="#A2D2DB", "THRA2"="#5A7C86")) +
scale_y_continuous("" ,limits=c(0, 100))+
geom_hline(yintercept=50, linetype="dashed", color = "#DC4E3C")+
labs(subtitle="",
title= "THRA isoform expression pattern - Mosdepth",
caption = "~58M uniquely mapped reads, n=1") +
theme(axis.title.y=element_blank()) +
coord_flip()
ggplot(total_plot, aes(x=Sample, y=Expression, label=Isoform)) +
geom_bar(stat='identity',position = "stack", aes(fill=Isoform), width=.5)  +
theme_light(base_size = 14)+
scale_fill_manual(name="Isoform",
labels = c( "THRA1", "THRA2"),
values = c("THRA1"="#A2D2DB", "THRA2"="#5A7C86")) +
scale_y_continuous("" ,limits=c(0, 100))+
geom_hline(yintercept=50, linetype="dashed", color = "#DC4E3C")+
labs(subtitle="",
title= "THRA isoform expression pattern - Mosdepth",
caption = "~58M uniquely mapped reads, n=1") +
theme(axis.title.y=element_blank()) +
coord_flip()
ggplot(total_plot, aes(x=Sample, y=Expression, label=Isoform)) +
geom_bar(stat='identity',position = "stack", aes(fill=Isoform), width=.5)  +
theme_light(base_size = 12)+
scale_fill_manual(name="Isoform",
labels = c( "THRA1", "THRA2"),
values = c("THRA1"="#A2D2DB", "THRA2"="#5A7C86")) +
scale_y_continuous("" ,limits=c(0, 100))+
geom_hline(yintercept=50, linetype="dashed", color = "#DC4E3C")+
labs(subtitle="",
title= "THRA isoform expression pattern - Mosdepth",
caption = "~58M uniquely mapped reads, n=1") +
theme(axis.title.y=element_blank()) +
coord_flip()
dataset_final <- dataset %>%
mutate("delta_A1vsA2" = THRA1 - THRA2) %>%
mutate("THRA1_Percentage" = round(THRA1/Read_counts_9a*100)) %>%
mutate("THRA2_Percentage" = round(100-THRA1_Percentage)) %>%
mutate("THRA1_higher" = THRA1 > THRA2) %>%
mutate("delta_percentage" = THRA1_Percentage - THRA2_Percentage)
dataset_final
# Barchart showing Expression of A1 and A2 over time in only control samples
total_plot <- filter(dataset_final, Treatment == "control") %>%
select(Sample,study_day,  THRA1, THRA2)
total_plot <- total_plot[order(total_plot$THRA2), ]  # sort
total_plot$Sample <- factor(total_plot$Sample, levels = total_plot$Sample)  # convert to factor to retain sorted order in plot.
total_plot <- pivot_longer(total_plot, c("THRA1","THRA2"), names_to = "Isoform", values_to = "Expression")
ggplot(total_plot, aes(x=study_day, y=Expression, label=Isoform)) +
geom_bar(stat='summary', position = "stack", aes(fill=Isoform), width=.5)  +
theme_light(base_size = 14)+
scale_y_continuous("Read counts") +
scale_fill_manual(name="Isoform",
labels = c( "THRA1", "THRA2"),
values = c("THRA1"="#A2D2DB", "THRA2"="#5A7C86")) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA isoform expression pattern",
caption = "~78M uniquely mapped reads, n>=2")
### Plot of Control vs T3 pulse over time - THRA
graph_data <- select(dataset_final, Sample,study_day,Treatment,  THRA1, THRA2, THRA, hiPSC_line)
ggbarplot(graph_data, x = "study_day", y = "THRA", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(80, 220, 255)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')+
theme_light(base_size = 14)
ggbarplot(graph_data, x = "study_day", y = "THRA1", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(300, 850, 800)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA1 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')+
theme_light(base_size = 14)
### Plot of Control vs T3 pulse over time - THRA2
ggbarplot(graph_data, x = "study_day", y = "THRA2", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(800, 1600, 2100)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA2 expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right') +
theme_light(base_size = 14)
### heatmap with continuos delta THRA1vsA2 using mosdepth
heatmap_data <- filter(dataset_final, Package == "mosdepth")
ggplot(heatmap_data, aes(1, reorder(Sample,delta_A1vsA2), fill=delta_A1vsA2)) +
geom_tile()+
ggtitle("THRA isoform expression pattern (THRA1/THRA2) - mosdepth") +
theme_light(base_size = 12)+
theme(axis.title.y=element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
scale_fill_gradient2('delta_reads', limits=c(-350, 350), breaks = c( -350, -150, 0, 150, 350),  low = "#56B4E9", high = "darksalmon", guide="colorbar")
### heatmap of percentages using mosdepth
heatmap_data <- filter(dataset_final, Package == "mosdepth")
ggplot(heatmap_data, aes(1, reorder(Sample,THRA1_Percentage), fill=THRA1_Percentage)) +
geom_tile()+
ggtitle("THRA isoform expression pattern (THRA1/THRA2) - mosdepth") +
theme_light(base_size = 12)+
theme(axis.title.y=element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
scale_fill_gradient2('% of THRA1', limits=c(0, 100), breaks = c( 0, 50, 100),  low = "#56B4E9", high = "darksalmon", guide="colorbar",  midpoint = 50)
heatmap_data_percentage <- filter(dataset_final, Package == "mosdepth")
heatmap_data_percentage <- heatmap_data_percentage[order(heatmap_data_percentage$delta_percentage), ]  # sort
heatmap_data_percentage$Sample <- factor(heatmap_data_percentage$Sample, levels = heatmap_data_percentage$Sample)  # convert to factor to retain sorted order in plot.
# Diverging Barcharts
ggplot(heatmap_data_percentage, aes(x=Sample, y=THRA1_Percentage, label=THRA1_Percentage)) +
geom_bar(stat='identity', aes(fill=THRA1_higher), width=.5)  +
theme_light(base_size = 12)+
scale_fill_manual(name="Predominant Isoform",
labels = c("THRA1", "THRA2"),
values = c("TRUE"="darksalmon", "FALSE"="#56B4E9")) +
scale_y_continuous("% THRA1" ,limits=c(0, 100))+
geom_hline(yintercept=50, linetype="dashed", color = "black")+
labs(subtitle="Percentage of THRA1 expression over the total of THRA",
title= "THRA isoform expression pattern - Mosdepth",
caption = "~58M uniquely mapped reads, n=1") +
theme(axis.title.y=element_blank()) +
coord_flip()
# Diverging Barcharts oh total THRA
total_plot <- filter(dataset_final, Package == "mosdepth") %>%
select(Sample, "THRA1" = THRA1_Percentage,"THRA2" = THRA2_Percentage)
total_plot <- total_plot[order(total_plot$THRA2), ]  # sort
total_plot$Sample <- factor(total_plot$Sample, levels = total_plot$Sample)  # convert to factor to retain sorted order in plot.
total_plot <- pivot_longer(total_plot, c("THRA1","THRA2"), names_to = "Isoform", values_to = "Expression")
ggplot(total_plot, aes(x=Sample, y=Expression, label=Isoform)) +
geom_bar(stat='identity',position = "stack", aes(fill=Isoform), width=.5)  +
theme_light(base_size = 12)+
scale_fill_manual(name="Isoform",
labels = c( "THRA1", "THRA2"),
values = c("THRA1"="#A2D2DB", "THRA2"="#5A7C86")) +
scale_y_continuous("" ,limits=c(0, 100))+
geom_hline(yintercept=50, linetype="dashed", color = "#DC4E3C")+
labs(subtitle="",
title= "THRA isoform expression pattern - Mosdepth",
caption = "~58M uniquely mapped reads, n=1") +
theme(axis.title.y=element_blank()) +
coord_flip()
# Diverging Barcharts
ggplot(heatmap_data_percentage, aes(x=Sample, y=delta_percentage, label=delta_percentage)) +
geom_bar(stat='identity', aes(fill=THRA1_higher), width=.5)  +
theme_light(base_size = 12)+
scale_fill_manual(name="Predominant Isoform",
labels = c("THRA1", "THRA2"),
values = c("TRUE"="darksalmon", "FALSE"="#56B4E9")) +
scale_y_continuous("Delta THRA1-THRA2 in %" ,limits=c(-100, 100))+
labs(subtitle="Delta THRA1-THRA2 expressed in percentage",
title= "THRA isoform expression pattern") +
theme(axis.title.y=element_blank()) +
coord_flip()
ggbarplot(graph_data, x = "study_day", y = "THRA", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#FEFADC", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(80, 220, 255)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')+
theme_light(base_size = 14)
ggbarplot(graph_data, x = "study_day", y = "THRA", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#DFD9E2", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(80, 220, 255)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')+
theme_light(base_size = 14)
ggbarplot(graph_data, x = "study_day", y = "THRA", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(80, 220, 255)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')+
theme_light(base_size = 14)
ggbarplot(graph_data, x = "study_day", y = "THRA", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#721817")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(80, 220, 255)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')+
theme_light(base_size = 14)
ggbarplot(graph_data, x = "study_day", y = "THRA", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#181F1C", "T3_pulse"="#721817")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(80, 220, 255)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')+
theme_light(base_size = 14)
ggbarplot(graph_data, x = "study_day", y = "THRA", add = "mean_se",
fill = "Treatment",
position = position_dodge(0.8)) +
scale_fill_manual("", values = c("control" = "#31092D", "T3_pulse"="#E98A33")) +
stat_compare_means(aes(group = Treatment), label = "p.signif", label.y = c(80, 220, 255)) +
labs(subtitle="Read counts calculated with Mosdepth",
title= "THRA expression of Cntrl vs T3 treatment over time",
caption = "Wilcoxon test, n>=2\n ~78M uniquely mapped reads") +
scale_y_continuous("Normalized read counts") +
theme(legend.position='right')+
theme_light(base_size = 14)
